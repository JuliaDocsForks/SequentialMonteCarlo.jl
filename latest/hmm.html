<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Hidden Markov models · SequentialMonteCarlo.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>SequentialMonteCarlo.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Contents</a></li><li><a class="toctext" href="intro.html">Introduction</a></li><li><a class="toctext" href="smcintegrals.html">SMC integrals</a></li><li><a class="toctext" href="smcalgorithm.html">SMC algorithm</a></li><li><a class="toctext" href="smctheory.html">Theoretical properties</a></li><li><a class="toctext" href="smcve.html">Variance estimators</a></li><li><a class="toctext" href="smcadaptive.html">Adaptive resampling</a></li><li><a class="toctext" href="csmc.html">Conditional SMC</a></li><li><a class="toctext" href="impl.html">Implementation notes</a></li><li><a class="toctext" href="performance.html">Performance tips</a></li><li><a class="toctext" href="smcinterface.html">SMC interface</a></li><li><a class="toctext" href="guide.html">Types and functions</a></li><li class="current"><a class="toctext" href="hmm.html">Hidden Markov models</a><ul class="internal"></ul></li><li><a class="toctext" href="bench.html">Benchmarks</a></li><li><a class="toctext" href="refs.html">References</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="hmm.html">Hidden Markov models</a></li></ul><a class="edit-page" href="https://github.com/awllee/SequentialMonteCarlo.jl/blob/master/docs/src/hmm.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Hidden Markov models</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Connection-to-hidden-Markov-models-1" href="#Connection-to-hidden-Markov-models-1">Connection to hidden Markov models</a></h1><p>Probably the most common use for SMC is in statistical applications involving hidden Markov models (HMMs), where the methodology originates. Indeed, there is a very simple correspondence between an HMM and an SMC model. The purpose of this part of the documentation is only to clarify how different SMC models can be associated with the same HMM.</p><p>An simple HMM can be described as a bivariate Markov chain <span>$(X_1,Y_1), \ldots, (X_n, Y_n)$</span> as follows. <span>$X_1, \ldots, X_n$</span> is a Markov chain determined by an initial distribution <span>$\mu$</span> and Markov transition densities <span>$f_2, \ldots, f_n$</span>. For each <span>$p \in \{1, \ldots, n\}$</span>, <span>$Y_p$</span> is conditionally independent of all other random variables given <span>$X_p$</span> and <span>$Y_p \mid (X_p = x)$</span> has density <span>$g_p(x,  \cdot)$</span>. Statistical inference for HMMs involve performing inference after observing <span>$(y_1, \ldots, y_n)$</span> as a realization of <span>$(Y_1, \ldots, Y_n)$</span>.</p><p>A standard use of SMC for such an HMM is as follows. Let the observations <span>$(y_1, \ldots, y_n)$</span> be given and choose <span>$M_1 = \mu$</span>, <span>$M_p(x, dx&#39;) = f_p(x, x&#39;) dx&#39;$</span> for <span>$p \in \{2, \ldots, n\}$</span> and <span>$G_p(x) = g_p(x, y_p)$</span> for <span>$p \in \{1, \ldots, n\}$</span>. Notice that the potential function <span>$G_p$</span> is defined using the observation <span>$y_p$</span>. Then it can be deduced that <span>$\hat{Z}_p$</span> is the <em>marginal likelihood</em> associated with the first <span>$p$</span> observations, <span>$\eta_p$</span> is the <em>predictive</em> distribution of <span>$X_p$</span> given the first <span>$p-1$</span> observations and <span>$\hat{\eta}_p$</span> is the <em>filtering</em> distribution of <span>$X_p$</span> given the first <span>$p$</span> observations. That is, \[ X<em>p \mid \{(Y</em>0, \ldots, Y<em>{p-1}) = (y</em>0, \ldots, y<em>{p-1})\} \sim \eta</em>p \] and \[ X<em>p \mid \{(Y</em>0, \ldots, Y<em>{p}) = (y</em>0, \ldots, y<em>{p})\} \sim \hat{\eta}</em>p. \]</p><p>However, this is only one way to map the HMM into an SMC Model. We extend the HMM&#39;s state space and define <span>$M_1(d(x_{\rm prev}, x)) = \mu(dx) \delta_x(dx_{\rm prev})$</span>, and \[ M<em>p((x</em>{\rm prev},x), d(x<em>{\rm prev}&#39;,x&#39;)) = q</em>p(x, x&#39;) \delta<em>x(dx</em>{\rm prev}&#39;), \qquad p \in \{2, \ldots, n\} \] where <span>$q_p$</span> is such that <span>$q_p(x, x&#39;) &gt; 0$</span> whenever <span>$f_p(x, x&#39;) &gt; 0$</span>. Then one can define \[ G<em>p(x</em>{\rm prev}, x) = \frac{f<em>p(x</em>{\rm prev}, x)}{q<em>p(x</em>{\rm prev}, x)} g(x, y<em>p), \qquad p \in \{1, \ldots, n\} \] and it is still the case that \hat{Z}</em>p$ is the marginal likelihood associated with the first <span>$p$</span> observations, <span>$\eta_p$</span> is the predictive distribution of <span>$X_p$</span> given the first <span>$p-1$</span> observations and <span>$\hat{\eta}_p$</span> is the filtering distribution of <span>$X_p$</span> given the first <span>$p$</span> observations. An example of using different SMC models for a given HMM is provided in <a href="https://github.com/awllee/SMCExamples.jl/blob/master/demo/lgComparisonDemo.jl">SMCExamples: comparison of Linear Gaussian models</a> ; the model associated with the &quot;locally optimal proposal&quot; is defined <a href="https://github.com/awllee/SMCExamples.jl/blob/master/src/lgLOPModel.jl">here</a>.</p><footer><hr/><a class="previous" href="guide.html"><span class="direction">Previous</span><span class="title">Types and functions</span></a><a class="next" href="bench.html"><span class="direction">Next</span><span class="title">Benchmarks</span></a></footer></article></body></html>
